Задача: создать десктоп приложение для работы с диаграммами ДРАКОН
лемента для редактирования

3. Поддержка старого и нового форматов файлов drakon:

	Пример старого формата файла drakon
	```json
	{
		"items": {
			"1": {
				"type": "end"
			},
			"2": {
				"type": "branch",
				"branchId": 0,
				"one": "3"
			},
			"3": {
				"type": "action",
				"content": "<p>действие</p>",
				"one": "1"
			}
		},
		"type": "drakon",
		"id": "01.drakon"
	}
	```

   - Старый формат (одна диаграмма) при открытии файла должен автоматически конвертироваться в новый:
     * Создается функция с именем "fun_Rename"
     * Содержимое переносится в items этой функции
     * Добавляются пустые header и footer

4. Новый обязательный формат файла:
   - Обязательные ключи верхнего уровня:
     * "type": "drakon"
     * "id": имя файла
     * "header": строка (может быть пустой)
     * "footer": строка (может быть пустой)
   - Функции хранятся как отдельные объекты с ключами:
     * "name": имя функции
     * "arguments": аргументы (строка)
     * "return_type": тип возвращаемого значения
     * "items": содержимое диаграммы

5. Пример нового формата:
```json
{
    "header": "код перед функциями",
    "function_01": {
        "name": "fsm",
        "arguments": "int i, str s",
        "return_type": "bool",
        "items": {
            "1": {"type": "end"},
            "2": {
                "type": "branch",
                "branchId": 0,
                "one": "3"
            },
            "3": {
                "type": "action",
                "content": "<p>действие</p>",
                "one": "1"
            }
        }
    },
    "footer": "код после функций",
    "type": "drakon",
    "id": "01.drakon"
}
```

6. Дополнительные требования:
   - Реализовать миграцию старых файлов в новый формат при открытии
   - Возможность добавления/удаления функций через интерфейс
   - При отсутствии обязательных полей - создать их

Новый код помечай комментариями со словом Trae и текущими дата-время в формате 2025-05-08 17:30